policy_id: G4_environment_V3
extends: G4_environment_V2
version: '1.0'
overview:
  title: Environment Quality Assessment
  purpose: |
    Help assess the physical environment quality at this restaurant using customer reviews as evidence.
    This is from the perspective of a business owner evaluating ambiance and comfort.
    Assign a quality label: Needs Improvement, Satisfactory, or Excellent.

    This assessment uses a point-based scoring system with recency weighting.
  incident_definition: |
    Consider reviews that mention any of the following:
    - cleanliness of the space
    - noise level
    - seating comfort
    - temperature comfort (AC, heating)
    - ambiance and decor fit with concept

    Reviews that only discuss food or service without mentioning environment carry less weight.
normative:
  terms:
  - ref: shared:ACCOUNT_TYPE
  - ref: environment:CLEANLINESS
  - ref: environment:NOISE_LEVEL
  - ref: environment:COMFORT
  - ref: environment:TEMPERATURE
  - ref: environment:AMBIANCE_FIT
  scoring:
    field_mapping:
      severity_field: ambiance_fit
      value_mappings:
        excellent: Exceptional atmosphere
        good: Pleasant environment
        fair: Adequate environment
        poor: Significant environment issue
      modifier_mappings:
      - field: cleanliness
        value: spotless
        label: Spotless clean
      - field: comfort
        value: very_comfortable
        label: Comfortable seating
      - field: noise_level
        value: loud
        label: Too loud
      - field: noise_level
        value: deafening
        label: Too loud
      - field: temperature
        value: too_cold
        label: Temperature issues
      - field: temperature
        value: too_hot
        label: Temperature issues
      - field: cleanliness
        value: dirty
        label: Dirty/unclean
    description: |
      Calculate a quality score by summing points from relevant reviews,
      with recency weighting. Environment can change with renovations
      or maintenance, so recent reviews are more indicative.
    severity_points:
    - label: Exceptional atmosphere
      points: 10
    - label: Pleasant environment
      points: 5
    - label: Adequate environment
      points: 0
    - label: Minor environment issue
      points: -2
    - label: Significant environment issue
      points: -5
    - label: Terrible environment
      points: -10
    modifiers:
    - label: Spotless clean
      description: cleanliness specifically praised
      points: 3
    - label: Perfect ambiance
      description: atmosphere matches and enhances concept
      points: 3
    - label: Comfortable seating
      description: seating comfort praised
      points: 2
    - label: Too loud
      description: noise level a significant problem
      points: -4
    - label: Temperature issues
      description: too hot or too cold
      points: -3
    - label: Dirty/unclean
      description: cleanliness issues noted
      points: -5
    recency_rules:
    - age: Within 6 months
      weight: full point value
    - age: 6 months to 1 year
      weight: three-quarter point value (multiply by 0.75)
    - age: 1-2 years old
      weight: half point value (multiply by 0.5)
    - age: Over 2 years old
      weight: quarter point value (multiply by 0.25) - unless describing permanent fixtures
    thresholds:
    - verdict: Excellent
      min_score: 900
      min_score_by_k:
        25: 113
        50: 225
        100: 450
    - verdict: Needs Improvement
      max_score: 200
      max_score_by_k:
        25: 25
        50: 50
        100: 100
  decision:
    verdicts:
    - Needs Improvement
    - Satisfactory
    - Excellent
    ordered: true
    rules:
    - verdict: Excellent
      label: EXCELLENT
      logic: ANY
      conditions:
      - Total quality score is 900 or higher (after recency weighting)
    - verdict: Needs Improvement
      label: NEEDS_IMPROVEMENT
      precondition: Excellent does not apply
      logic: ANY
      conditions:
      - Total quality score is 200 or lower (after recency weighting)
    - verdict: Satisfactory
      label: SATISFACTORY
      default: true
  output:
    verdict:
      type: enum
      values:
      - Needs Improvement
      - Satisfactory
      - Excellent
      required: true
    evidence:
      type: array
      items:
        review_id: string
        quote: string
      description: Relevant quotes supporting the verdict
    justification:
      type: string
      required: true
      description: Explain how the evidence and recency weighting were used to arrive at the final verdict
    confidence:
      type: enum
      values:
      - low
      - medium
      - high
      note: 'Based on evidence volume: low=1-2, medium=3-5, high=6+ relevant reviews'
    other_notes:
      type: string
      optional: true
      description: Any other relevant observations or caveats
