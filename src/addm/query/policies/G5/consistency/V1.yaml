policy_id: G5_consistency_V1
extends: G5_consistency_V0
version: '1.0'
overview:
  title: Consistency Assessment
  purpose: |
    Help assess the quality consistency at this restaurant using reviews as evidence.
    This is from the perspective of a business owner diagnosing reliability.
    Assign a label: Needs Improvement, Satisfactory, or Excellent.
  incident_definition: |
    Consider reviews that mention any of the following:
    - quality changes over time
    - comparison to previous visits
    - reliability and predictability
    - repeat customer observations

    Reviews from first-time visitors that don't mention consistency carry less weight.
normative:
  terms:
  - ref: shared:ACCOUNT_TYPE
  - ref: consistency:QUALITY_TREND
  - ref: consistency:VISIT_COMPARISON
  - ref: consistency:RELIABILITY
  - ref: consistency:VISIT_FREQUENCY
  decision:
    verdicts:
    - Needs Improvement
    - Satisfactory
    - Excellent
    ordered: true
    rules:
    - verdict: Excellent
      label: EXCELLENT
      logic: ANY
      conditions:
      - text: 25 or more reviews describe it as always reliable
        type: count_threshold
        filter:
          reliability: always_reliable
        min_count: 25
        min_count_by_k:
          25: 5
          50: 8
          100: 15
      - text: 150 or more reviews describe quality as stable
        type: count_threshold
        filter:
          quality_trend: stable
        min_count: 150
        min_count_by_k:
          25: 22
          50: 42
          100: 80
      - text: 5 or more frequent customers describe always reliable experience
        type: count_threshold
        filter:
          reliability: always_reliable
          visit_frequency: frequent
        min_count: 5
        min_count_by_k:
          25: 2
          50: 2
          100: 3
      - text: 15 or more reviews describe improving quality
        type: count_threshold
        filter:
          quality_trend: improving
        min_count: 15
        min_count_by_k:
          25: 4
          50: 6
          100: 10
    - verdict: Needs Improvement
      label: NEEDS_IMPROVEMENT
      precondition: Excellent does not apply
      logic: ANY
      conditions:
      - text: 25 or more reviews describe declining quality
        type: count_threshold
        filter:
          quality_trend: declining
        min_count: 25
        min_count_by_k:
          25: 5
          50: 8
          100: 15
      - text: 50 or more reviews describe it as hit or miss
        type: count_threshold
        filter:
          reliability: hit_or_miss
        min_count: 50
        min_count_by_k:
          25: 8
          50: 15
          100: 28
      - text: 15 or more reviews describe it as unpredictable
        type: count_threshold
        filter:
          reliability: unpredictable
        min_count: 15
        min_count_by_k:
          25: 4
          50: 6
          100: 10
      - text: 10 or more reviews describe visit being much worse
        type: count_threshold
        filter:
          visit_comparison: much_worse
        min_count: 10
        min_count_by_k:
          25: 3
          50: 4
          100: 6
    - verdict: Satisfactory
      label: SATISFACTORY
      default: true
  output:
    verdict:
      type: enum
      values:
      - Needs Improvement
      - Satisfactory
      - Excellent
      required: true
    evidence:
      type: array
      items:
        review_id: string
        quote: string
      description: Relevant quotes supporting the verdict
    justification:
      type: string
      required: true
      description: Explain how the evidence was used to arrive at the final verdict
    confidence:
      type: enum
      values:
      - low
      - medium
      - high
      note: 'Based on evidence volume: low=1-2, medium=3-5, high=6+ relevant reviews'
    other_notes:
      type: string
      optional: true
      description: Any other relevant observations or caveats
