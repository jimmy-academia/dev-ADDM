# G3_time_value_V1: Time-Value with Override Triggers
# V1 = Extended: Multiple conditions per verdict (ANY triggers)

policy_id: "G3_time_value_V1"
extends: "G3_time_value_V0"
version: "1.0"

# === OVERVIEW (generates Overview section) ===
overview:
  title: "Time-Value Assessment"

  purpose: |
    Help assess whether waiting at this restaurant is worth it using customer reviews as evidence.
    Assign a verdict: Not Worth Waiting, Worth Waiting, or Definitely Worth Waiting.

  incident_definition: |
    Consider reviews that mention any of the following:
    - wait times for seating, food, or service
    - reservations and whether they were honored
    - whether the wait was justified by the experience
    - willingness to wait again

    Reviews that don't mention timing or waiting carry less weight.

# === NORMATIVE (generates Definitions + Verdict Rules) ===
normative:
  # Terms -> auto-generates Definitions section
  terms:
    - ref: "shared:ACCOUNT_TYPE"
    - ref: "time_value:WAIT_TYPE"
    - ref: "time_value:WAIT_DURATION"
    - ref: "time_value:WAIT_JUSTIFICATION"
    - ref: "time_value:WOULD_WAIT_AGAIN"

  # Decision policy -> generates Verdict Rules section
  decision:
    verdicts: ["Not Worth Waiting", "Worth Waiting", "Definitely Worth Waiting"]
    ordered: true

    rules:
      # V1 includes V0 conditions PLUS additional conditions
      - verdict: "Definitely Worth Waiting"
        label: "DEFINITELY"
        logic: ANY
        conditions:
          # V0 conditions (same thresholds)
          - text: "80 or more reviews say it was definitely worth the wait"
            type: count_threshold
            filter:
              wait_justification: definitely_worth_it
            min_count: 80
            min_count_by_k:
              25: 10
              50: 20
              100: 40
          - text: "100 or more reviews say they would definitely wait again"
            type: count_threshold
            filter:
              would_wait_again: definitely
            min_count: 100
            min_count_by_k:
              25: 13
              50: 25
              100: 50
          # V1 additional conditions
          - text: "50 or more reviews mention quick service"
            type: count_threshold
            filter:
              wait_duration: quick
            min_count: 50
            min_count_by_k:
              25: 6
              50: 13
              100: 25

      - verdict: "Not Worth Waiting"
        label: "NOT_WORTH"
        precondition: "Definitely Worth Waiting does not apply"
        logic: ANY
        conditions:
          # V0 conditions (same thresholds)
          - text: "50 or more reviews describe waits as 'not worth it'"
            type: count_threshold
            filter:
              wait_justification: not_worth_it
            min_count: 50
            min_count_by_k:
              25: 6
              50: 13
              100: 25
          - text: "35 or more reviews say they would never wait again"
            type: count_threshold
            filter:
              would_wait_again: never
            min_count: 35
            min_count_by_k:
              25: 4
              50: 9
              100: 18
          # V1 additional conditions
          - text: "10 or more reviews describe excessive wait duration"
            type: count_threshold
            filter:
              wait_duration: excessive
            min_count: 10
            min_count_by_k:
              25: 1
              50: 3
              100: 5
          - text: "20 or more reviews say it was barely worth the wait"
            type: count_threshold
            filter:
              wait_justification: barely
            min_count: 20
            min_count_by_k:
              25: 3
              50: 5
              100: 10

      - verdict: "Worth Waiting"
        label: "WORTH"
        default: true
        especially_when:
          - "Reasonable waits for good food"
          - "Some timing issues but overall positive"
          - "Wait acceptable for the type of restaurant"

  # Output format
  output:
    verdict:
      type: enum
      values: ["Not Worth Waiting", "Worth Waiting", "Definitely Worth Waiting"]
      required: true

    evidence:
      type: array
      items:
        review_id: string
        quote: string
      description: "Relevant quotes supporting the verdict"

    justification:
      type: string
      required: true
      description: "Explain how the evidence was used to arrive at the final verdict"

    confidence:
      type: enum
      values: ["low", "medium", "high"]
      note: "Based on evidence volume: low=1-2, medium=3-5, high=6+ relevant reviews"

    other_notes:
      type: string
      optional: true
      description: "Any other relevant observations or caveats"
