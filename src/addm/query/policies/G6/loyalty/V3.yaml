policy_id: G6_loyalty_V3
extends: G6_loyalty_V2
version: '1.0'
overview:
  title: Customer Loyalty Assessment
  purpose: |
    Help assess customer loyalty and retention indicators using reviews as evidence.
    This is from the perspective of a business owner evaluating customer loyalty.
    Assign a label: Low Loyalty, Moderate Loyalty, or High Loyalty.

    This assessment uses a point-based scoring system with recency weighting.
  incident_definition: |
    Consider reviews that mention any of the following:
    - return visits or intention to return
    - recommendations to others
    - emotional attachment or connection
    - loyalty despite issues

    Reviews from first-time visitors that don't mention return intent carry less weight.
normative:
  terms:
  - ref: shared:ACCOUNT_TYPE
  - ref: loyalty:RETURN_INTENT
  - ref: loyalty:RECOMMEND_INTENT
  - ref: loyalty:EMOTIONAL_CONNECTION
  - ref: loyalty:LOYALTY_DRIVER
  scoring:
    field_mapping:
      severity_field: return_intent
      value_mappings:
        definitely: Will definitely return
        likely: Might return
        unlikely: Probably won't return
        never: Never returning
      modifier_mappings:
      - field: recommend_intent
        value: strongly_recommend
        label: Strong recommendation
      - field: emotional_connection
        value: high
        label: Returned after issue
      - field: recommend_intent
        value: warn_others
        label: Warns others away
    description: |
      Calculate a loyalty score by summing points from relevant reviews,
      with recency weighting. Loyalty patterns can shift as restaurants change,
      so recent reviews are weighted more heavily.
    severity_points:
    - label: Regular customer
      points: 10
    - label: Will definitely return
      points: 5
    - label: Might return
      points: 2
    - label: Probably won't return
      points: -5
    - label: Never returning
      points: -10
    modifiers:
    - label: Strong recommendation
      description: actively tells others to go
      points: 5
    - label: Returned after issue
      description: loyalty despite problems
      points: 8
    - label: Warns others away
      description: actively discourages visits
      points: -5
    - label: Switched to competitor
      description: explicitly left for alternative
      points: -8
    recency_rules:
    - age: Within 6 months
      weight: full point value
    - age: 6 months to 1 year
      weight: three-quarter point value (multiply by 0.75)
    - age: 1-2 years old
      weight: half point value (multiply by 0.5)
    - age: Over 2 years old
      weight: quarter point value (multiply by 0.25) - loyalty patterns may have changed
    thresholds:
    - verdict: High Loyalty
      min_score: 1400
      min_score_by_k:
        25: 175
        50: 350
        100: 700
    - verdict: Low Loyalty
      max_score: 100
      max_score_by_k:
        25: -100
        50: 0
        100: 50
  decision:
    verdicts:
    - Low Loyalty
    - Moderate Loyalty
    - High Loyalty
    ordered: true
    rules:
    - verdict: High Loyalty
      label: HIGH_LOYALTY
      logic: ANY
      conditions:
      - Total score is 1400 or higher (after recency weighting)
    - verdict: Low Loyalty
      label: LOW_LOYALTY
      precondition: High Loyalty does not apply
      logic: ANY
      conditions:
      - Total score is 100 or lower (after recency weighting)
    - verdict: Moderate Loyalty
      label: MODERATE_LOYALTY
      default: true
  output:
    verdict:
      type: enum
      values:
      - Low Loyalty
      - Moderate Loyalty
      - High Loyalty
      required: true
    evidence:
      type: array
      items:
        review_id: string
        quote: string
      description: Relevant quotes supporting the verdict
    justification:
      type: string
      required: true
      description: Explain how the evidence and recency weighting were used to arrive at the final verdict
    confidence:
      type: enum
      values:
      - low
      - medium
      - high
      note: 'Based on evidence volume: low=1-2, medium=3-5, high=6+ relevant reviews'
    other_notes:
      type: string
      optional: true
      description: Any other relevant observations or caveats
