============================================================
Agenda
============================================================

Help assess how suitable this restaurant is for business dining.

Analyze each review to identify mentions of business meals or professional contexts.
For each record, extract the L0 primitives defined below.

This task combines complex formula (weighted factors, interactions)
with L1.5 meeting type grouping for pattern detection.

============================================================
L0: Primitives (per-review extraction)
============================================================

MEETING_TYPE
- client_meeting: entertaining clients, business development
- team_lunch: colleagues dining together
- interview: job interview or candidate meeting
- working_session: working while eating (laptop, documents)
- business_general: professional context without specific type
- not_business: not a business context

NOISE_LEVEL
- quiet: easy to have professional conversation
- moderate: acceptable for business discussion
- loud: difficult to conduct business
- not_mentioned: noise not discussed

WIFI_AVAILABILITY
- available: WiFi mentioned as available
- fast: WiFi specifically noted as fast/reliable
- slow: WiFi available but slow
- unavailable: no WiFi or poor connectivity
- not_mentioned: WiFi not discussed

PROFESSIONAL_ATMOSPHERE
- formal: upscale, professional environment
- business_casual: appropriate for most business contexts
- casual: relaxed but acceptable
- inappropriate: too casual or distracting for business
- not_mentioned: atmosphere not discussed

SERVICE_TIMING
- efficient: quick service, good pacing for business needs
- appropriate: reasonable timing
- slow: service too slow for business lunch
- rushed: felt rushed, uncomfortable for meetings
- not_mentioned: timing not discussed

SEATING_SUITABILITY
- excellent: private rooms, booths, good for meetings
- adequate: reasonable seating for business
- poor: cramped, no privacy, uncomfortable
- not_mentioned: seating not discussed

OUTCOME_IMPRESSION
- impressed: client/guest was impressed, meeting went well
- satisfied: acceptable outcome
- embarrassed: felt embarrassed by restaurant choice
- not_mentioned: outcome not discussed

============================================================
L1: Composites (derived per review) - COMPLEX
============================================================

Meeting Stakes Weight:
  client_meeting = 2.0
  interview = 1.8
  team_lunch = 1.0
  working_session = 1.2
  business_general = 1.0
  not_business = 0

Noise Score:
  quiet = +2.5
  moderate = +1
  loud = -3
  not_mentioned = 0

WiFi Score:
  fast = +2
  available = +1
  slow = -0.5
  unavailable = -1.5
  not_mentioned = 0

Atmosphere Score:
  formal = +2.5
  business_casual = +1.5
  casual = +0.5
  inappropriate = -2
  not_mentioned = 0

Timing Score:
  efficient = +2
  appropriate = +0.5
  slow = -2
  rushed = -1.5
  not_mentioned = 0

Seating Score:
  excellent = +2
  adequate = +0.5
  poor = -1.5
  not_mentioned = 0

Outcome Modifier:
  impressed = +3
  satisfied = +1
  embarrassed = -4
  not_mentioned = 0

L1_REVIEW_SCORE = (NOISE_SCORE + ATMOSPHERE_SCORE + TIMING_SCORE + SEATING_SCORE + OUTCOME_MODIFIER) * MEETING_STAKES_WEIGHT

WIFI_BONUS (interaction for working sessions):
  If MEETING_TYPE = working_session AND WIFI_AVAILABILITY = fast: +2.0
  If MEETING_TYPE = working_session AND WIFI_AVAILABILITY = unavailable: -3.0
  Else: WIFI_SCORE * 0.5

EMBARRASSED_CLIENT (interaction effect):
  If MEETING_TYPE = client_meeting AND OUTCOME_IMPRESSION = embarrassed: -5.0
  Else: 0

L1_TOTAL_SCORE = L1_REVIEW_SCORE + WIFI_BONUS + EMBARRASSED_CLIENT

============================================================
L1.5: Meeting Type Grouping
============================================================

Group reviews by MEETING_TYPE:
  HIGH_STAKES = client_meeting, interview (impression matters)
  TEAM_CASUAL = team_lunch, business_general (colleagues, less formal)
  WORKING = working_session (needs WiFi, power, quiet)

For each meeting bucket, compute:
  BUCKET_N_REVIEWS = count of reviews in this bucket
  BUCKET_SUM_SCORE = sum of L1_TOTAL_SCORE in bucket
  BUCKET_SUM_WEIGHT = sum of MEETING_STAKES_WEIGHT in bucket
  BUCKET_WEIGHTED_SCORE = BUCKET_SUM_SCORE / max(BUCKET_SUM_WEIGHT, 1)
  BUCKET_N_IMPRESSED = count where OUTCOME_IMPRESSION = impressed in bucket
  BUCKET_N_EMBARRASSED = count where OUTCOME_IMPRESSION = embarrassed in bucket

Meeting Pattern Analysis:
  BEST_MEETING_TYPE = bucket with highest WEIGHTED_SCORE (if any data)
  BEST_MEETING_SCORE = WEIGHTED_SCORE of BEST_MEETING_TYPE
  WORST_MEETING_TYPE = bucket with lowest WEIGHTED_SCORE (if any data)
  WORST_MEETING_SCORE = WEIGHTED_SCORE of WORST_MEETING_TYPE
  N_MEETING_TYPES_EXCELLENT = count of buckets where WEIGHTED_SCORE >= 3.0

  BUSINESS_VERSATILITY:
    if N_MEETING_TYPES_EXCELLENT >= 3: "complete_business_venue"
    elif HIGH_STAKES bucket WEIGHTED_SCORE >= 4.0: "client_meeting_champion"
    elif WORKING bucket WEIGHTED_SCORE >= 4.0: "remote_work_haven"
    elif TEAM_CASUAL bucket WEIGHTED_SCORE >= 3.0: "team_bonding_spot"
    elif BEST_MEETING_SCORE - WORST_MEETING_SCORE > 4.0: "inconsistent"
    elif BEST_MEETING_SCORE >= 2.0: "situational"
    else: "not_recommended"

============================================================
L2: Aggregates (restaurant-level)
============================================================

Constants:
  BASE_SCORE = 5.0

Counts:
  N_BUSINESS_REVIEWS = count of reviews where MEETING_TYPE != not_business
  N_HIGH_STAKES = count where MEETING_TYPE in {client_meeting, interview}
  N_EMBARRASSED = count where OUTCOME_IMPRESSION = embarrassed
  N_IMPRESSED = count where OUTCOME_IMPRESSION = impressed

Confidence Level:
  if N_BUSINESS_REVIEWS == 0: none
  elif N_BUSINESS_REVIEWS <= 2: low
  elif N_BUSINESS_REVIEWS <= 5: medium
  else: high

L1.5 Meeting Aggregation:
  TOTAL_MEETING_SCORE = sum of BUCKET_WEIGHTED_SCORE across all meeting buckets
  N_MEETING_BUCKETS_ACTIVE = count of buckets where N_REVIEWS > 0
  MEAN_MEETING_SCORE = TOTAL_MEETING_SCORE / max(N_MEETING_BUCKETS_ACTIVE, 1)

============================================================
Formulas & Decision Policy
============================================================

Formulas:
  Versatility Multiplier (based on business versatility):
    if BUSINESS_VERSATILITY = "complete_business_venue": VERS_MULT = 1.2
    elif BUSINESS_VERSATILITY = "client_meeting_champion": VERS_MULT = 1.15
    elif BUSINESS_VERSATILITY = "remote_work_haven": VERS_MULT = 1.1
    elif BUSINESS_VERSATILITY = "inconsistent": VERS_MULT = 0.9
    elif BUSINESS_VERSATILITY = "not_recommended": VERS_MULT = 0.7
    else: VERS_MULT = 1.0

  ADJUSTED_SCORE = MEAN_MEETING_SCORE * VERS_MULT
  RAW_SCORE = BASE_SCORE + ADJUSTED_SCORE
  FINAL_SCORE = clamp(RAW_SCORE, 0.0, 10.0)

Decision Thresholds on FINAL_SCORE:
  - >= 7.5 => Excellent for Business
  - >= 5.5 AND < 7.5 => Good for Business
  - >= 3.5 AND < 5.5 => Acceptable
  - < 3.5 => Not Suitable

Overrides:
  - If N_EMBARRASSED >= 1 AND was HIGH_STAKES => max Acceptable
  - If BUSINESS_VERSATILITY = "complete_business_venue" => min Good for Business
  - If BUSINESS_VERSATILITY = "client_meeting_champion" AND N_IMPRESSED >= 2 => min Good for Business
  - If HIGH_STAKES bucket N_EMBARRASSED >= 1 => include warning in verdict
  - If BUSINESS_VERSATILITY = "inconsistent" => include meeting guidance

============================================================
Output Schema
============================================================

{
  L0_primitives: [ ... one record per business-related review ... ],
  L1_composites: [
    {
      review_id,
      meeting_type,
      meeting_stakes_weight,
      noise_score,
      wifi_score,
      atmosphere_score,
      timing_score,
      seating_score,
      outcome_modifier,
      l1_review_score,
      wifi_bonus,
      embarrassed_client,
      l1_total_score
    },
    ...
  ],
  L1_5_meeting_buckets: {
    high_stakes: { n_reviews, sum_score, sum_weight, weighted_score, n_impressed, n_embarrassed },
    team_casual: { n_reviews, sum_score, sum_weight, weighted_score, n_impressed, n_embarrassed },
    working: { n_reviews, sum_score, sum_weight, weighted_score, n_impressed, n_embarrassed },
    best_meeting_type,
    best_meeting_score,
    worst_meeting_type,
    worst_meeting_score,
    n_meeting_types_excellent,
    business_versatility
  },
  L2_aggregates: {
    N_BUSINESS_REVIEWS,
    CONFIDENCE_LEVEL,
    N_HIGH_STAKES,
    N_EMBARRASSED,
    N_IMPRESSED,
    TOTAL_MEETING_SCORE,
    MEAN_MEETING_SCORE,
    VERS_MULT,
    BASE_SCORE,
    ADJUSTED_SCORE,
    RAW_SCORE,
    FINAL_SCORE
  },
  DecisionPolicy: {
    base_verdict_by_score,
    override_applied,
    VERDICT,
    meeting_guidance (if applicable),
    high_stakes_warning (if applicable)
  },
  decision_evidence: {
    high_score_reviews: [ {review_id, meeting_type, l1_total_score, quote}, ... ],
    low_score_reviews: [ {review_id, meeting_type, l1_total_score, quote}, ... ],
    meeting_evidence: {
      best_meeting_type,
      best_meeting_score,
      worst_meeting_type,
      business_versatility
    }
  }
}
